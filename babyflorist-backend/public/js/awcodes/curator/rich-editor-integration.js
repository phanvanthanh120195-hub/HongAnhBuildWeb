(function(){"use strict";if(window.__curatorRichEditorInitialized)return;window.__curatorRichEditorInitialized=!0;let s=null,d=null,c=null,u=!1;document.addEventListener("click",function(m){let r=m.target.closest("button");if(!r)return;let o=r.closest(".fi-fo-rich-editor");if(!o)return;let e=o.querySelector('[x-data*="richEditorFormComponent"]');if(!e)return;let t=(e.getAttribute("x-data")||"").match(/key:\s*['"]([^'"]+)['"]/);s=t?t[1]:null,d=o.closest("[wire\\:id]")?.getAttribute("wire:id");try{let i=Alpine.$data(e);if(i?.getEditor){let l=i.getEditor();l?.state?.selection&&(c={type:"text",anchor:l.state.selection.anchor,head:l.state.selection.head})}}catch{c={type:"text",anchor:1,head:1}}},!0);function y(m){if(!u){u=!0;try{let r=m.detail;Array.isArray(r)&&(r=r[0]);let{statePath:o,media:e}=r||{};if(!o||!e)return;let t=(Array.isArray(e)?e:[e])[0];if(!t?.url)return;let a=s,i=d,l=c;if(!a||!i){let n=document.querySelector(".fi-fo-rich-editor");if(!n)return;let f=n.querySelector('[x-data*="richEditorFormComponent"]');if(!f)return;let h=(f.getAttribute("x-data")||"").match(/key:\s*['"]([^'"]+)['"]/);a=h?h[1]:null,i=n.closest("[wire\\:id]")?.getAttribute("wire:id")}if(!a||!i)return;window.dispatchEvent(new CustomEvent("run-rich-editor-commands",{detail:{key:a,livewireId:i,commands:[{name:"focus"},{name:"setImage",arguments:[{src:t.url,alt:t.alt||t.title||"",title:t.title||"",id:t.id||null}]}],editorSelection:l||{type:"text",anchor:1,head:1}}})),s=null,d=null,c=null,setTimeout(()=>{let n=document.querySelector('.fi-modal button[type="button"] svg[class*="x-mark"]')?.closest("button")||document.querySelector('.fi-modal [x-on\\:click*="close"]');n&&n.click()},100)}finally{setTimeout(()=>{u=!1},300)}}}window.addEventListener("insert-media",y)})();
